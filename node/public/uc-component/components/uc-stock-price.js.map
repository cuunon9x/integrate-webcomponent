{"file":"uc-stock-price.js","mappings":"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","names":[],"sources":["./src/components/stock-price/stock-price.css?tag=uc-stock-price&encapsulation=shadow","./src/components/stock-price/stock-price.tsx"],"sourcesContent":[":host {\r\n  font-family: sans-serif;\r\n  border: 2px solid #3b013b;\r\n  margin: 2rem;\r\n  padding: 1rem;\r\n  display: block;\r\n  width: 20rem;\r\n  max-width: 100%;\r\n}\r\n:host(.error) {\r\n  border-color: orange;\r\n}\r\nform input {\r\n  font: inherit;\r\n  color: #3b013b;\r\n  padding: 0.1rem 0.25rem;\r\n  display: block;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\nform input:focus,\r\nform button:focus {\r\n  outline: none;\r\n}\r\n\r\nform button {\r\n  font: inherit;\r\n  padding: 0.25rem 0.5rem;\r\n  border: 1px solid #3b013b;\r\n  background: #3b013b;\r\n  color: white;\r\n  cursor: pointer;\r\n}\r\n\r\nform button:hover,\r\nform button:active {\r\n  background: #750175;\r\n  border-color: #750175;\r\n}\r\nform button:disabled {\r\n  background: #ccc;\r\n  border-color: #ccc;\r\n  color: white;\r\n  cursor: not-allowed;\r\n}\r\n\r\n","import {\r\n  Component,\r\n  State,\r\n  Element,\r\n  h,\r\n  Prop,\r\n  Listen,\r\n  Watch,\r\n} from \"@stencil/core\";\r\nimport { API_KEY } from \"../../global/global\";\r\n@Component({\r\n  tag: \"uc-stock-price\",\r\n  styleUrl: \"./stock-price.css\",\r\n  shadow: true,\r\n})\r\nexport class StockPrice {\r\n  stockInput: HTMLInputElement;\r\n  // initialStockSymbol: string;\r\n  @Element() el: HTMLElement;\r\n  @State() fetchedPrice: number;\r\n  @State() stockSymbolValue: string;\r\n  @State() isStockInputValid = false;\r\n  @State() error: string;\r\n  @State() loading = false;\r\n  @Prop() stockSymbol: string;\r\n  @Watch(\"stockSymbol\")\r\n  stockSymbolChanged(newValue: string, oldValue: string) {\r\n    if (newValue !== oldValue) {\r\n      this.stockSymbolValue = newValue;\r\n      this.isStockInputValid = true;\r\n      // this.fetchStockPrice(newValue);\r\n    }\r\n  }\r\n  onStockValueChange(event: Event) {\r\n    this.stockSymbolValue = (event.target as HTMLInputElement).value;\r\n    if (this.stockSymbolValue.trim() !== \"\") {\r\n      this.isStockInputValid = true;\r\n    } else {\r\n      this.isStockInputValid = false;\r\n    }\r\n  }\r\n  onFetchStockPrice(e: Event) {\r\n    e.preventDefault();\r\n    // const stockSymbol = (\r\n    //   this.el.shadowRoot.querySelector(\"#stock-symbol\") as HTMLInputElement\r\n    // ).value;\r\n    const stockSymbol = this.stockInput.value;\r\n    this.fetchStockPrice(stockSymbol);\r\n  }\r\n  componentWillLoad() {\r\n    console.log(\"will load\");\r\n  }\r\n  componentDidLoad() {\r\n    console.log(\"did load\");\r\n\r\n    if (this.stockSymbol) {\r\n      // this.initialStockSymbol = this.stockSymbol;\r\n      this.stockSymbolValue = this.stockSymbol;\r\n      this.isStockInputValid = true;\r\n      this.fetchStockPrice(this.stockSymbol);\r\n    }\r\n  }\r\n  componentWillUpdate() {\r\n    console.log(\"will update\");\r\n  }\r\n  componentDidUpdate() {\r\n    console.log(\"did update\");\r\n    // this.fetchStockPrice(this.stockInput.value);\r\n  }\r\n  disconnectedCallback() {\r\n    console.log(\"disconnectedCallback\");\r\n  }\r\n  @Listen(\"ucSymbolSelected\", { target: \"body\" })\r\n  onStockSymbolSelected(event: CustomEvent) {\r\n    console.log(\"Stock symbol selected\" + event.detail);\r\n    if (event?.detail !== this.stockSymbol) {\r\n      this.stockSymbol = event.detail;\r\n      this.fetchStockPrice(event.detail);\r\n    }\r\n  }\r\n  fetchStockPrice(stockSymbol: string) {\r\n    this.loading = true;\r\n    fetch(\r\n      // `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=MSFT&apikey=demo`\r\n      `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${stockSymbol}&apikey=${API_KEY}`\r\n    )\r\n      .then((result) => {\r\n        if (!result.ok) {\r\n          throw new Error(\"Invalid!\");\r\n        }\r\n        return result.json();\r\n      })\r\n      .then((parsedRes) => {\r\n        if (!parsedRes[\"Global Quote\"]) {\r\n          this.error = \"Invalid Stock Symbol!\";\r\n          throw new Error(\"Invalid Stock Symbol!\");\r\n        }\r\n        this.error = \"\";\r\n        this.fetchedPrice = +parsedRes[\"Global Quote\"][\"05. price\"];\r\n        this.loading = false;\r\n      })\r\n      .catch((err) => {\r\n        this.error = err.message;\r\n        this.loading = false;\r\n      });\r\n  }\r\n  hostData() {\r\n    return { class: this.error ? \"error\" : \"\" };\r\n  }\r\n  render() {\r\n    let dataContent = <p>Please enter a symbol!</p>;\r\n    if (this.error) {\r\n      dataContent = <p>{this.error}</p>;\r\n    }\r\n    if (this.fetchedPrice) {\r\n      dataContent = <p>Price: ${this.fetchedPrice}</p>;\r\n    }\r\n    if (this.loading) {\r\n      dataContent = <uc-spinner-loading></uc-spinner-loading>;\r\n    }\r\n    return [\r\n      <form onSubmit={(e) => this.onFetchStockPrice(e)}>\r\n        <input\r\n          id=\"stock-symbol\"\r\n          ref={(el) => (this.stockInput = el)}\r\n          value={this.stockSymbolValue}\r\n          onInput={this.onStockValueChange.bind(this)}\r\n        ></input>\r\n        <button\r\n          type=\"submit\"\r\n          disabled={!this.isStockInputValid || this.loading}\r\n        >\r\n          Fetch\r\n        </button>\r\n      </form>,\r\n      <div>{dataContent}</div>,\r\n    ];\r\n  }\r\n}\r\n"],"version":3}